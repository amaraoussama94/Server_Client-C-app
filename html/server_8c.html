<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PIKA_PIKA: /home/oussama.amara@sofia.local/Desktop/test-dev/server.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PIKA_PIKA
   &#160;<span id="projectnumber">0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_124f36899e96ff6c9b1081cddbca33d9.html">test-dev</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">server.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the server side, it should run all time waiting for client to connect. The server has two arguments "-p" followed by the port number to use for this server then "-d" followed by the path of the directory to share.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;netdb.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_const_8h_source.html">Const.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arg__test_8h_source.html">arg_test.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for server.c:</div>
<div class="dyncontent">
<div class="center"><img src="server_8c__incl.png" border="0" usemap="#a_2home_2oussama_8amara_0dsofia_8local_2_desktop_2test-dev_2server_8c" alt=""/></div>
<map name="a_2home_2oussama_8amara_0dsofia_8local_2_desktop_2test-dev_2server_8c" id="a_2home_2oussama_8amara_0dsofia_8local_2_desktop_2test-dev_2server_8c">
<area shape="rect" title="This is the server side, it should run all time waiting for client to connect. The server has two arg..." alt="" coords="501,5,673,61"/>
<area shape="rect" title=" " alt="" coords="5,184,97,211"/>
<area shape="rect" title=" " alt="" coords="122,184,189,211"/>
<area shape="rect" title=" " alt="" coords="213,184,284,211"/>
<area shape="rect" title=" " alt="" coords="309,184,405,211"/>
<area shape="rect" title=" " alt="" coords="429,184,500,211"/>
<area shape="rect" title=" " alt="" coords="524,184,595,211"/>
<area shape="rect" title=" " alt="" coords="811,184,913,211"/>
<area shape="rect" title=" " alt="" coords="938,184,1034,211"/>
<area shape="rect" title=" " alt="" coords="899,109,974,136"/>
<area shape="rect" title=" " alt="" coords="1059,184,1127,211"/>
<area shape="rect" href="_const_8h.html" title="This header file includes all the constant variables used in this project.." alt="" coords="1151,184,1221,211"/>
<area shape="rect" href="arg__test_8h.html" title="This is the header file containing all the function declarations to verify the argument for the serve..." alt="" coords="585,109,672,136"/>
<area shape="rect" title=" " alt="" coords="619,184,689,211"/>
<area shape="rect" title=" " alt="" coords="714,184,786,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9368c696bfda42cce823526a47747243"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a9368c696bfda42cce823526a47747243">SendFileToClient</a> (int *ptr_connfd, char *fname, struct sockaddr_in cli)</td></tr>
<tr class="memdesc:a9368c696bfda42cce823526a47747243"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sends the file to the client we talk about text , video , image ,pdf ..files . It has three parameters " cli  " ," fname " and "  connfd ".  <a href="server_8c.html#a9368c696bfda42cce823526a47747243">More...</a><br /></td></tr>
<tr class="separator:a9368c696bfda42cce823526a47747243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ebcca7a5ee8fb298c279aaf92bab4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a30ebcca7a5ee8fb298c279aaf92bab4a">share_msg</a> (int *ptr_connfd, char **argv, struct sockaddr_in cli, int *ptr_change)</td></tr>
<tr class="memdesc:a30ebcca7a5ee8fb298c279aaf92bab4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function uses the code send by the client to know what it should do, if there's no code send then the function returns 1. If the code is "list" this function will get the list of file and folder in the shared folder using the script the output will redirect to text file. If the code is "transmit" then the code uses the name of file, send by the client then start transmit it to the client. . It has two parameters " *ptr_connfd  " and "  **argv ". "  **argv ".  <a href="server_8c.html#a30ebcca7a5ee8fb298c279aaf92bab4a">More...</a><br /></td></tr>
<tr class="separator:a30ebcca7a5ee8fb298c279aaf92bab4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f86fa435dab7d56c4bb21db0cd61298"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a3f86fa435dab7d56c4bb21db0cd61298">create_scoket</a> (int *sockfd)</td></tr>
<tr class="memdesc:a3f86fa435dab7d56c4bb21db0cd61298"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will create the socket as TCP using IPV4. It has one parameter " *sockfd   ".  <a href="server_8c.html#a3f86fa435dab7d56c4bb21db0cd61298">More...</a><br /></td></tr>
<tr class="separator:a3f86fa435dab7d56c4bb21db0cd61298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a10bf8741d17ff5173419b94a0ff516"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a0a10bf8741d17ff5173419b94a0ff516">socket_bind</a> (struct sockaddr_in *servaddr, int *sockfd)</td></tr>
<tr class="memdesc:a0a10bf8741d17ff5173419b94a0ff516"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will bind the port number and the address. It has two parameters " servaddr  " and "  sockfd ".  <a href="server_8c.html#a0a10bf8741d17ff5173419b94a0ff516">More...</a><br /></td></tr>
<tr class="separator:a0a10bf8741d17ff5173419b94a0ff516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b2ac860096ce0ecda783ae7ec98614"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#aa5b2ac860096ce0ecda783ae7ec98614">socket_listening</a> (int *sockfd)</td></tr>
<tr class="memdesc:aa5b2ac860096ce0ecda783ae7ec98614"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function listens up to 5 connection requests. It has one parameter " sockfd  ".  <a href="server_8c.html#aa5b2ac860096ce0ecda783ae7ec98614">More...</a><br /></td></tr>
<tr class="separator:aa5b2ac860096ce0ecda783ae7ec98614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6db7b22c08fdde92c75c35c1e3e6a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a8c6db7b22c08fdde92c75c35c1e3e6a4">socket_accept</a> (int *connfd, int *sockfd, struct sockaddr_in *cli, int *len)</td></tr>
<tr class="memdesc:a8c6db7b22c08fdde92c75c35c1e3e6a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function accept client connection . It has for parameters " sockfd  " , " cli "and " ," len " connfd ".  <a href="server_8c.html#a8c6db7b22c08fdde92c75c35c1e3e6a4">More...</a><br /></td></tr>
<tr class="separator:a8c6db7b22c08fdde92c75c35c1e3e6a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function main function will return 0 if it run succefuly. It has two parameters " argc  " and "  **argv ".  <a href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the server side, it should run all time waiting for client to connect. The server has two arguments "-p" followed by the port number to use for this server then "-d" followed by the path of the directory to share. </p>
<dl class="section author"><dt>Author</dt><dd>oussama amara </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.5 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11/1/2022 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3f86fa435dab7d56c4bb21db0cd61298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f86fa435dab7d56c4bb21db0cd61298">&#9670;&nbsp;</a></span>create_scoket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_scoket </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sockfd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will create the socket as TCP using IPV4. It has one parameter " *sockfd   ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*sockfd</td><td>Pointer container of port number and address of the server . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function main function will return 0 if it run succefuly. It has two parameters " argc  " and "  **argv ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>number of arguments passed to the server +1 (name of the script) . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">**argv</td><td>Pointer to pointer contain the name and the argument such as the path to the folder to share. . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0 for success </dd></dl>

</div>
</div>
<a id="a9368c696bfda42cce823526a47747243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9368c696bfda42cce823526a47747243">&#9670;&nbsp;</a></span>SendFileToClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SendFileToClient </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ptr_connfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in&#160;</td>
          <td class="paramname"><em>cli</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sends the file to the client we talk about text , video , image ,pdf ..files . It has three parameters " cli  " ," fname " and "  connfd ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*fname</td><td>pointer to the file name that we will send to the client . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cli</td><td>client struct , we need it to get the Ipadress of the client who connect to our server </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*connfd</td><td>Pointer serve as the channel between the client and the server, aka all transmitted data can be read using this variable . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a30ebcca7a5ee8fb298c279aaf92bab4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30ebcca7a5ee8fb298c279aaf92bab4a">&#9670;&nbsp;</a></span>share_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int share_msg </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ptr_connfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in&#160;</td>
          <td class="paramname"><em>cli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ptr_change</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function uses the code send by the client to know what it should do, if there's no code send then the function returns 1. If the code is "list" this function will get the list of file and folder in the shared folder using the script the output will redirect to text file. If the code is "transmit" then the code uses the name of file, send by the client then start transmit it to the client. . It has two parameters " *ptr_connfd  " and "  **argv ". "  **argv ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">**argv</td><td>Pointer to pointer contain the name and the argument such as the path to the folder to share. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*ptr_connfd</td><td>Pointer serve as the channel between the client and the server, aka all transmitted data can be read using this variable . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a8c6db7b22c08fdde92c75c35c1e3e6a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6db7b22c08fdde92c75c35c1e3e6a4">&#9670;&nbsp;</a></span>socket_accept()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void socket_accept </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>connfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&#160;</td>
          <td class="paramname"><em>cli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function accept client connection . It has for parameters " sockfd  " , " cli "and " ," len " connfd ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*cli</td><td>client structure which contains all info about the client . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*len</td><td>pointer length of the client structure . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*sockfd</td><td>Pointer container of port number and address of the server <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*connfd</td><td>Pointer serve as the channel between the client and the server, aka all transmitted data can be read using this variable . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a0a10bf8741d17ff5173419b94a0ff516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a10bf8741d17ff5173419b94a0ff516">&#9670;&nbsp;</a></span>socket_bind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void socket_bind </td>
          <td>(</td>
          <td class="paramtype">struct sockaddr_in *&#160;</td>
          <td class="paramname"><em>servaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sockfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will bind the port number and the address. It has two parameters " servaddr  " and "  sockfd ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*servaddr</td><td>pointer to structure that contains the port number and address of the server . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*sockfd</td><td>Pointer container of port number and address of the server . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="aa5b2ac860096ce0ecda783ae7ec98614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b2ac860096ce0ecda783ae7ec98614">&#9670;&nbsp;</a></span>socket_listening()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void socket_listening </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sockfd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function listens up to 5 connection requests. It has one parameter " sockfd  ". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*sockfd</td><td>Pointer container of port number and address of the server . </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
